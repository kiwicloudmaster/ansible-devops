<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://ibm-mas.github.io/ansible-devops/roles/cp4d_hack_worker_nodes/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>cp4d_hack_worker_nodes - MAS Devops Collection</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "cp4d_hack_worker_nodes";
    var mkdocs_page_input_path = "roles/cp4d_hack_worker_nodes.md";
    var mkdocs_page_url = "/ansible-devops/roles/cp4d_hack_worker_nodes/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MAS Devops Collection</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Full Stack Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/fullstack-roks/">IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Lite Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-core-roks/">Core only on IBM Cloud</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-core-quickburn/">Core only on QuickBurn</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-manage-roks/">Manage on IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Other Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/ocp/">OCP Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/dependencies/">Dependencies Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/cp4d/">CP4D Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/mas/">MAS Playbooks</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Roles</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../amqstreams/">amqstreams</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ansible_version_check/">ansible_version_check</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../appconnect_install/">appconnect_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cos_setup/">cos_setup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh/">cp4d_db2wh</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh_backup/">cp4d_db2wh_backup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh_manage_hack/">cp4d_db2wh_manage_hack</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh_restore/">cp4d_db2wh_restore</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">cp4d_hack_worker_nodes</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#role-variables">Role Variables</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cluster_type">cluster_type</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cluster_name">cluster_name</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ibmcloud_apikey">ibmcloud_apikey</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpd_entitlement_key">cpd_entitlement_key</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-playbook">Example Playbook</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#license">License</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_install/">cp4d_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_install_services/">cp4d_install_services</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../db2u/">db2u</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../gencfg_sls/">gencfg_sls</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../gencfg_workspace/">gencfg_workspace</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../install_operator/">install_operator</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mongodb/">mongodb</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_deprovision/">ocp_deprovision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_login/">ocp_login</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_provision/">ocp_provision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_github_oauth/">ocp_setup_github_oauth</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_mas_deps/">ocp_setup_mas_deps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_ocs/">ocp_setup_ocs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_verify/">ocp_verify</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sls_install/">sls_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_app_configure/">suite_app_configure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_app_install/">suite_app_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_config/">suite_config</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_dns/">suite_dns</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_install/">suite_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_mustgather/">suite_mustgather</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_verify/">suite_verify</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../uds_install/">uds_install</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MAS Devops Collection</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Roles &raquo;</li>
        
      
    
    <li>cp4d_hack_worker_nodes</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/roles/cp4d_hack_worker_nodes.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="cp4d_hack_worker_nodes">cp4d_hack_worker_nodes<a class="headerlink" href="#cp4d_hack_worker_nodes" title="Permanent link"></a></h1>
<p>This is a horrible hack, but it's what CP4D tells us to do :(</p>
<p>This should be executed as part of cluster prepararion if you want to use CP4D v4.  It will reboot all worker nodes, causing disruption to the entire cluster and everything running on it we do not include this as part of the normal flow because, well it shouldn't be necessary to reboot worker nodes to install containerized software.  Hopefully this is just an example of poor documentation and there's a simple alternative that we can implement to remove this role.</p>
<p>For more information, refer to https://cloud.ibm.com/docs/openshift?topic=openshift-registry#cluster_global_pull_secret</p>
<h2 id="role-variables">Role Variables<a class="headerlink" href="#role-variables" title="Permanent link"></a></h2>
<h3 id="cluster_type">cluster_type<a class="headerlink" href="#cluster_type" title="Permanent link"></a></h3>
<p>Required.  Note that only supported value at present is <code>roks</code>.</p>
<ul>
<li>Environment Variable: <code>CLUSTER_TYPE</code></li>
<li>Default Value: None</li>
</ul>
<h3 id="cluster_name">cluster_name<a class="headerlink" href="#cluster_name" title="Permanent link"></a></h3>
<p>Required.  The name of the ROKS cluster that we are going to apply the CP4D hack to.</p>
<ul>
<li>Environment Variable: <code>CLUSTER_NAME</code></li>
<li>Default Value: None</li>
</ul>
<h3 id="ibmcloud_apikey">ibmcloud_apikey<a class="headerlink" href="#ibmcloud_apikey" title="Permanent link"></a></h3>
<p>Required.  Provide your IBM Cloud API Key, this will be used to query the status of the cluster and issue the node restart commands.</p>
<ul>
<li>Environment Variable: <code>IBMCLOUD_APIKEY</code></li>
<li>Default Value: None</li>
</ul>
<h3 id="cpd_entitlement_key">cpd_entitlement_key<a class="headerlink" href="#cpd_entitlement_key" title="Permanent link"></a></h3>
<p>Required.  Provide your IBM Entitlement Key.</p>
<ul>
<li>Environment Variable: <code>CPD_ENTITLEMENT_KEY</code></li>
<li>Default Value: None</li>
</ul>
<h2 id="example-playbook">Example Playbook<a class="headerlink" href="#example-playbook" title="Permanent link"></a></h2>
<pre><code class="language-yaml">- hosts: localhost
  any_errors_fatal: true
  vars:
    cluster_name: mycluster
    cluster_type: roks
    ibmcloud_apikey: &quot;{{ lookup('env', 'IBMCLOUD_APIKEY') }}&quot;

    cpd_entitlement_key: &quot;{{ lookup('env', 'CPD_ENTITLEMENT_KEY') }}&quot;

  roles:
    - ibm.mas_devops.cp4d_hack_worker_nodes
</code></pre>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link"></a></h2>
<p>EPL-2.0</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/ansible-devops/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../cp4d_db2wh_restore/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cp4d_install/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
