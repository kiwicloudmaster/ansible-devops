<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://ibm-mas.github.io/ansible-devops/roles/cp4d_db2wh/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>cp4d_db2wh - MAS Devops Collection</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "cp4d_db2wh";
    var mkdocs_page_input_path = "roles/cp4d_db2wh.md";
    var mkdocs_page_url = "/ansible-devops/roles/cp4d_db2wh/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MAS Devops Collection</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Full Stack Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/fullstack-roks/">IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Lite Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-core-roks/">Core only on IBM Cloud</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-core-quickburn/">Core only on QuickBurn</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/lite-manage-roks/">Manage on IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Other Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/ocp/">OCP Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/dependencies/">Dependencies Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/cp4d/">CP4D Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../playbooks/mas/">MAS Playbooks</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Roles</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../amqstreams/">amqstreams</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ansible_version_check/">ansible_version_check</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../appconnect_install/">appconnect_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cos_setup/">cos_setup</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">cp4d_db2wh</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#cloudpak-for-data-35">CloudPak for Data 3.5</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#debugging-db2-install-problems">Debugging Db2 install problems</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#installing-db2wh-on-nfs-based-volumes">Installing DB2WH on NFS based volumes</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#role-variables">Role Variables</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_namespace">db2wh_namespace</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_instance_name">db2wh_instance_name</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_version">db2wh_version</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_table_org">db2wh_table_org</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_meta_storage_class">db2wh_meta_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_meta_storage_size_gb">db2wh_meta_storage_size_gb</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_user_storage_class">db2wh_user_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_user_storage_size_gb">db2wh_user_storage_size_gb</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_backup_storage_class">db2wh_backup_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_backup_storage_size_gb">db2wh_backup_storage_size_gb</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_logs_storage_class">db2wh_logs_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_logs_storage_size_gb">db2wh_logs_storage_size_gb</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_temp_storage_class">db2wh_temp_storage_class</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_temp_storage_size_gb">db2wh_temp_storage_size_gb</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_cpu_requests">db2wh_cpu_requests</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_cpu_limits">db2wh_cpu_limits</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_memory_requests">db2wh_memory_requests</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_memory_limits">db2wh_memory_limits</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpd_entitlement_key">cpd_entitlement_key</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpd_api_username">cpd_api_username</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpd_api_password">cpd_api_password</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_instance_id">mas_instance_id</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_config_dir">mas_config_dir</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_config_scope">mas_config_scope</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_workspace_id">mas_workspace_id</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#mas_application_id">mas_application_id</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_workload">db2wh_workload</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_node_label">db2wh_node_label</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_dedicated_node">db2wh_dedicated_node</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_mln_count">db2wh_mln_count</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#db2wh_num_pods">db2wh_num_pods</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-playbook">Example Playbook</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#license">License</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh_backup/">cp4d_db2wh_backup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh_manage_hack/">cp4d_db2wh_manage_hack</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_db2wh_restore/">cp4d_db2wh_restore</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_hack_worker_nodes/">cp4d_hack_worker_nodes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_install/">cp4d_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d_install_services/">cp4d_install_services</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../db2u/">db2u</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../gencfg_sls/">gencfg_sls</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../gencfg_workspace/">gencfg_workspace</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../install_operator/">install_operator</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mongodb/">mongodb</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_deprovision/">ocp_deprovision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_login/">ocp_login</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_provision/">ocp_provision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_github_oauth/">ocp_setup_github_oauth</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_mas_deps/">ocp_setup_mas_deps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_setup_ocs/">ocp_setup_ocs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp_verify/">ocp_verify</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sls_install/">sls_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_app_configure/">suite_app_configure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_app_install/">suite_app_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_config/">suite_config</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_dns/">suite_dns</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_install/">suite_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_mustgather/">suite_mustgather</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../suite_verify/">suite_verify</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../uds_install/">uds_install</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MAS Devops Collection</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Roles &raquo;</li>
        
      
    
    <li>cp4d_db2wh</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/roles/cp4d_db2wh.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="cp4d_db2wh">cp4d_db2wh<a class="headerlink" href="#cp4d_db2wh" title="Permanent link"></a></h1>
<p>This role creates a Db2 Warehouse instance in Cloud Pak for Data.  A Db2 Warehouse cluster will be created and a public TLS encrypted route is configured to allow external access to the cluster.</p>
<h3 id="cloudpak-for-data-35">CloudPak for Data 3.5<a class="headerlink" href="#cloudpak-for-data-35" title="Permanent link"></a></h3>
<p>The certificates are available from the <code>internal-tls</code> secret in the <code>cpd-meta-ops</code> namespace.  The default user is <code>db2inst1</code> and the password is available in the <code>instancepassword</code> secret in the same namespace.  You can examine the deployed resources in the <code>cpd-meta-ops</code> namespace:</p>
<pre><code class="language-bash">oc -n cpd-meta-ops get cpdservice,db2ucluster

NAME                                                       MESSAGE                 REASON   STATUS       LASTACTION   PHASE        CODE
cpdservice.metaoperator.cpd.ibm.com/cpdservice-db2wh       Completed                        Ready        CPDInstall   Ready        0
cpdservice.metaoperator.cpd.ibm.com/cpdservice-db2wh-dmc   CPD binary is running            Installing   CPDInstall   Installing   1

NAME                                            STATE      AGE
db2ucluster.db2u.databases.ibm.com/db2u-bludb   NotReady   8m44s
</code></pre>
<h4 id="debugging-db2-install-problems">Debugging Db2 install problems<a class="headerlink" href="#debugging-db2-install-problems" title="Permanent link"></a></h4>
<p>The following command may come in handy:</p>
<pre><code class="language-bash">oc -n cpd-meta-ops get formations.db2u.databases.ibm.com db2wh-db01 -o go-template='{{range .status.components}}{{printf &quot;%s,%s,%s\n&quot; .kind .name .status.state}}{{end}}' | column -s, -t
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The role will generate a yaml file containing the definition of a Secret and JdbcCfg resource that can be used to configure the deployed cluster as the MAS system JDBC datasource.</p>
<p>This file can be directly applied using <code>oc apply -f /tmp/jdbccfg-cp4ddb2wh-system.yaml</code> or added to the <code>mas_config</code> list variable used by the <code>ibm.mas_devops.suite_install</code> role to deploy and configure MAS.</p>
</div>
<h4 id="installing-db2wh-on-nfs-based-volumes">Installing DB2WH on NFS based volumes<a class="headerlink" href="#installing-db2wh-on-nfs-based-volumes" title="Permanent link"></a></h4>
<p>DB2 requires you to set no_root_squash when you use NFS with IBM® Cloud File Storage (ibmc-file-gold-gid storage class) or the restore morph job fails.
This role will install a daemonset which applies the <code>no_root_squash</code> NFS mount option on NFS volumes. For more details see the following references:
- https://www.ibm.com/docs/en/db2/11.5?topic=requirements-cloud-file-storage
- https://www.ibm.com/docs/en/db2/11.5?topic=cds-nfs-storage-requirements-1
- https://cloud.ibm.com/docs/FileStorage?topic=FileStorage-mountingLinux&amp;interface=ui#norootsquash</p>
<h2 id="role-variables">Role Variables<a class="headerlink" href="#role-variables" title="Permanent link"></a></h2>
<h3 id="db2wh_namespace">db2wh_namespace<a class="headerlink" href="#db2wh_namespace" title="Permanent link"></a></h3>
<p>Only supported when using CloudPak for Data v4.0, otherwise unused. For v3.5 support the value is always set to <code>cpd-meta-ops</code>.</p>
<ul>
<li>Environment Variable: <code>DB2WH_NAMESPACE</code></li>
<li>Default Value: <code>cpd-services</code></li>
</ul>
<h3 id="db2wh_instance_name">db2wh_instance_name<a class="headerlink" href="#db2wh_instance_name" title="Permanent link"></a></h3>
<p>Required.  Name of the database instance, note that this is the instance <strong>name</strong>, which is different from the instance <strong>ID</strong>.</p>
<ul>
<li>Environment Variable: <code>DB2WH_INSTANCE_NAME</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_version">db2wh_version<a class="headerlink" href="#db2wh_version" title="Permanent link"></a></h3>
<p>Version of the DB2 Warehouse instance to be created.</p>
<ul>
<li>Environment Variable: <code>DB2WH_VERSION</code></li>
<li>Default: <code>11.5.5.1-cn3-x86_64</code> (CloudPak for Data v3.5), <code>11.5.6.0-cn3</code> (CloudPak for Data v4)</li>
</ul>
<h3 id="db2wh_table_org">db2wh_table_org<a class="headerlink" href="#db2wh_table_org" title="Permanent link"></a></h3>
<p>The way database tables will be organized. It can be set to either <code>ROW</code> or <code>COLUMN</code>.</p>
<ul>
<li>Environment Variable: <code>DB2WH_TABLE_ORG</code></li>
<li>Default: <code>ROW</code></li>
</ul>
<h3 id="db2wh_meta_storage_class">db2wh_meta_storage_class<a class="headerlink" href="#db2wh_meta_storage_class" title="Permanent link"></a></h3>
<p>Required for both CP4D v3.5 and CP4D v4.  Storage class used for metadata.</p>
<ul>
<li>Environment Variable: <code>DB2WH_META_STORAGE_CLASS</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_meta_storage_size_gb">db2wh_meta_storage_size_gb<a class="headerlink" href="#db2wh_meta_storage_size_gb" title="Permanent link"></a></h3>
<p>Size of the metadata persistent volume, in gigabytes</p>
<ul>
<li>Environment Variable: <code>DB2WH_META_STORAGE_SIZE_GB</code></li>
<li>Default: <code>20</code></li>
</ul>
<h3 id="db2wh_user_storage_class">db2wh_user_storage_class<a class="headerlink" href="#db2wh_user_storage_class" title="Permanent link"></a></h3>
<p>Required for both CP4D v3.5 and CP4D v4.  Storage class used for user data.</p>
<ul>
<li>Environment Variable: <code>DB2WH_USER_STORAGE_CLASS</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_user_storage_size_gb">db2wh_user_storage_size_gb<a class="headerlink" href="#db2wh_user_storage_size_gb" title="Permanent link"></a></h3>
<p>Size of user persistent volume, in gigabytes.</p>
<ul>
<li>Environment Variable: <code>DB2WH_USER_STORAGE_SIZE_GB</code></li>
<li>Default: <code>100</code></li>
</ul>
<h3 id="db2wh_backup_storage_class">db2wh_backup_storage_class<a class="headerlink" href="#db2wh_backup_storage_class" title="Permanent link"></a></h3>
<p>Required for both CP4D v3.5 and CP4D v4.  Storage class used for backup.</p>
<ul>
<li>Environment Variable: <code>DB2WH_BACKUP_STORAGE_CLASS</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_backup_storage_size_gb">db2wh_backup_storage_size_gb<a class="headerlink" href="#db2wh_backup_storage_size_gb" title="Permanent link"></a></h3>
<p>Size of backup persistent volume, in gigabytes.</p>
<ul>
<li>Environment Variable: <code>DB2WH_BACKUP_STORAGE_SIZE_GB</code></li>
<li>Default: <code>100</code></li>
</ul>
<h3 id="db2wh_logs_storage_class">db2wh_logs_storage_class<a class="headerlink" href="#db2wh_logs_storage_class" title="Permanent link"></a></h3>
<p>Required for CP4D v4 only.  Storage class used for logs, not used with CP4D v3.5 databases.</p>
<ul>
<li>Environment Variable: <code>DB2WH_LOGS_STORAGE_CLASS</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_logs_storage_size_gb">db2wh_logs_storage_size_gb<a class="headerlink" href="#db2wh_logs_storage_size_gb" title="Permanent link"></a></h3>
<p>Size (in gigabytes) of logs persistent volume, not used with CP4D v3.5 databases.</p>
<ul>
<li>Environment Variable: <code>DB2WH_LOGS_STORAGE_SIZE_GB</code></li>
<li>Default: <code>100</code></li>
</ul>
<h3 id="db2wh_temp_storage_class">db2wh_temp_storage_class<a class="headerlink" href="#db2wh_temp_storage_class" title="Permanent link"></a></h3>
<p>Required for CP4D v4 only.  Storage class used for temporary data, not used with CP4D v3.5 databases.</p>
<ul>
<li>Environment Variable: <code>DB2WH_TEMP_STORAGE_CLASS</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_temp_storage_size_gb">db2wh_temp_storage_size_gb<a class="headerlink" href="#db2wh_temp_storage_size_gb" title="Permanent link"></a></h3>
<p>Size (in gigabytes) of temporary persistent volume, not used with CP4D v3.5 databases.</p>
<ul>
<li>Environment Variable: <code>DB2WH_TEMP_STORAGE_SIZE_GB</code></li>
<li>Default: <code>100</code></li>
</ul>
<h3 id="db2wh_cpu_requests">db2wh_cpu_requests<a class="headerlink" href="#db2wh_cpu_requests" title="Permanent link"></a></h3>
<p>Define the Kubernetes CPU request for the Db2 pod.  Only supported with CloudPak for Data v4.</p>
<ul>
<li>Environment Variable: <code>DB2WH_CPU_REQUESTS</code></li>
<li>Default: <code>2000m</code></li>
</ul>
<h3 id="db2wh_cpu_limits">db2wh_cpu_limits<a class="headerlink" href="#db2wh_cpu_limits" title="Permanent link"></a></h3>
<p>Define the Kubernetes CPU limit for the Db2 pod.  Only supported with CloudPak for Data v4.</p>
<ul>
<li>Environment Variable: <code>DB2WH_CPU_LIMITS</code></li>
<li>Default: <code>4000m</code></li>
</ul>
<h3 id="db2wh_memory_requests">db2wh_memory_requests<a class="headerlink" href="#db2wh_memory_requests" title="Permanent link"></a></h3>
<p>Define the Kubernetes memory request for the Db2 pod.  Only supported with CloudPak for Data v4.</p>
<ul>
<li>Environment Variable: <code>DB2WH_MEMORY_REQUESTS</code></li>
<li>Default: <code>6Gi</code></li>
</ul>
<h3 id="db2wh_memory_limits">db2wh_memory_limits<a class="headerlink" href="#db2wh_memory_limits" title="Permanent link"></a></h3>
<p>Define the Kubernetes memory limit for the Db2 pod.  Only supported with CloudPak for Data v4.</p>
<ul>
<li>Environment Variable: <code>DB2WH_MEMORY_LIMITS</code></li>
<li>Default: <code>12Gi</code></li>
</ul>
<h3 id="cpd_entitlement_key">cpd_entitlement_key<a class="headerlink" href="#cpd_entitlement_key" title="Permanent link"></a></h3>
<p>Required.  This is the entitlement key used to install the norootsquash Daemonset in the <code>kube-system</code> namespace. Holds your IBM Entitlement key.</p>
<ul>
<li>Environment Variable: <code>CPD_ENTITLEMENT_KEY</code></li>
<li>Default: None</li>
</ul>
<h3 id="cpd_api_username">cpd_api_username<a class="headerlink" href="#cpd_api_username" title="Permanent link"></a></h3>
<p>Required for CP4D v3.5 only.  These credentials are used to call the REST API to create the database because CP4D v3.5 Kubernetes API is broken.  Yes, the default admin account for CP4D v3.5 really is set up as admin/password.</p>
<ul>
<li>Environment Variable: <code>CPD_API_USERNAME</code></li>
<li>Default: <code>admin</code></li>
</ul>
<h3 id="cpd_api_password">cpd_api_password<a class="headerlink" href="#cpd_api_password" title="Permanent link"></a></h3>
<p>Required for CP4D v3.5 only.  These credentials are used to call the REST API to create the database because CP4D v3.5 Kubernetes API is broken.  Yes, the default admin account for CP4D v3.5 really is set up as admin/password.</p>
<ul>
<li>Environment Variable: <code>CPD_API_PASSWORD</code></li>
<li>Default: <code>password</code></li>
</ul>
<h3 id="mas_instance_id">mas_instance_id<a class="headerlink" href="#mas_instance_id" title="Permanent link"></a></h3>
<p>Providing this and <code>mas_config_dir</code> will instruct the role to generate a JdbcCfg template that can be used to configure MAS to connect to this database.</p>
<ul>
<li>Environment Variable: <code>MAS_INSTANCE_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_config_dir">mas_config_dir<a class="headerlink" href="#mas_config_dir" title="Permanent link"></a></h3>
<p>Providing this and <code>mas_instance_id</code> will instruct the role to generate a JdbcCfg template that can be used to configure MAS to connect to this database.</p>
<ul>
<li>Environment Variable: <code>MAS_CONFIG_DIR</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_config_scope">mas_config_scope<a class="headerlink" href="#mas_config_scope" title="Permanent link"></a></h3>
<p>Supported values are <code>system</code>, <code>ws</code>, <code>app</code>, or <code>wsapp</code>, this is only used when both <code>mas_config_dir</code> and <code>mas_instance_id</code> are set.</p>
<ul>
<li>Environment Variable: <code>MAS_CONFIG_SCOPE</code></li>
<li>Default: <code>system</code></li>
</ul>
<h3 id="mas_workspace_id">mas_workspace_id<a class="headerlink" href="#mas_workspace_id" title="Permanent link"></a></h3>
<p>This is only used when both <code>mas_config_dir</code> and <code>mas_instance_id</code> are set, and <code>mas_config_scope</code> is set to either <code>ws</code> or <code>wsapp</code></p>
<ul>
<li>Environment Variable: <code>MAS_WORKSPACE_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_application_id">mas_application_id<a class="headerlink" href="#mas_application_id" title="Permanent link"></a></h3>
<p>This is only used when both <code>mas_config_dir</code> and <code>mas_instance_id</code> are set, and <code>mas_config_scope</code> is set to either <code>app</code> or <code>wsapp</code></p>
<ul>
<li>Environment Variable: <code>'MAS_APP_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_workload">db2wh_workload<a class="headerlink" href="#db2wh_workload" title="Permanent link"></a></h3>
<p>The workload profile of the db2wh instance, possible values are 'PUREDATA_OLAP' or 'ANALYTICS'</p>
<ul>
<li>Environment Variable: <code>'DB2WH_WORKLOAD</code></li>
<li>Default: 'ANALYTICS'</li>
</ul>
<h3 id="db2wh_node_label">db2wh_node_label<a class="headerlink" href="#db2wh_node_label" title="Permanent link"></a></h3>
<p>The label used to specify node affinity and tolerations in the db2ucluster CR.</p>
<ul>
<li>Environment Variable: <code>'DB2WH_NODE_LABEL</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_dedicated_node">db2wh_dedicated_node<a class="headerlink" href="#db2wh_dedicated_node" title="Permanent link"></a></h3>
<p>The name of the worker node to apply the {{ db2wh_node_label }} taint and label to.</p>
<ul>
<li>Environment Variable: <code>'DB2WH_DEDICATED_NODE</code></li>
<li>Default: None</li>
</ul>
<h3 id="db2wh_mln_count">db2wh_mln_count<a class="headerlink" href="#db2wh_mln_count" title="Permanent link"></a></h3>
<p>The number of logical nodes (i.e. database partitions to create).</p>
<ul>
<li>Environment Variable: <code>'DB2WH_MLN_COUNT</code></li>
<li>Default: 1</li>
</ul>
<h3 id="db2wh_num_pods">db2wh_num_pods<a class="headerlink" href="#db2wh_num_pods" title="Permanent link"></a></h3>
<p>The number of Db2 pods to create in the instance. Note that <code>db2wh_num_pods</code> must be less than or equal to <code>db2wh_mln_count</code>.  A single db2u pod can contain multiple logical nodes. So be sure to avoid specifying a large number for <code>db2wh_mln_count</code> while specifying a small number for <code>db2wh_num_pods</code>. If in doubt, make <code>db2wh_mln_count = db2wh_num_pods</code>. For more information refer to the <a href="https://www.ibm.com/docs/en/db2-warehouse?topic=SSCJDQ/com.ibm.swg.im.dashdb.ucontainer.doc/doc/db2w-mempernode-new.html">Db2 documentation</a>.</p>
<ul>
<li>Environment Variable: <code>'DB2WH_NUM_PODS</code></li>
<li>Default: 1</li>
</ul>
<h2 id="example-playbook">Example Playbook<a class="headerlink" href="#example-playbook" title="Permanent link"></a></h2>
<pre><code class="language-yaml">- hosts: localhost
  any_errors_fatal: true
  vars:
    # Create a Db2 instance in CPD v4.0
    db2wh_instance_name: db2wh-shared

    # Configure storage suitable for IBM Cloud ROKS
    db2wh_meta_storage_class: ibmc-file-silver-gid
    db2wh_user_storage_class: ibmc-file-gold-gid
    db2wh_backup_storage_class: ibmc-file-gold-gid
    db2wh_logs_storage_class: ibmc-file-silver-gid
    db2wh_temp_storage_class: ibmc-file-silver-gid

    # Create the MAS JdbcCfg &amp; Secret resource definitions
    mas_instance_id: &quot;{{ lookup('env', 'MAS_INSTANCE_ID') }}&quot;
    mas_config_dir: &quot;{{ lookup('env', 'MAS_CONFIG_DIR') }}&quot;
  roles:
    - ibm.mas_devops.cp4d_db2wh
</code></pre>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link"></a></h2>
<p>EPL-2.0</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/ansible-devops/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../cos_setup/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cp4d_db2wh_backup/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
