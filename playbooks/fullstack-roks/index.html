<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://ibm-mas.github.io/ansible-devops/playbooks/fullstack-roks/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>IBM Cloud - MAS Devops Collection</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="../../extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "IBM Cloud";
    var mkdocs_page_input_path = "playbooks/fullstack-roks.md";
    var mkdocs_page_url = "/ansible-devops/playbooks/fullstack-roks/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MAS Devops Collection</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Full Stack Playbooks</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">IBM Cloud</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#preparation">Preparation</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#copy-your-entitlement-license-key-file">Copy your entitlement license key file</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#required-environment-variables">Required environment variables</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#optional-environment-variables">Optional environment variables</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#release-build">Release build</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pre-release-build">Pre-release build</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Lite Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../lite-core-roks/">Core only on IBM Cloud</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../lite-core-quickburn/">Core only on QuickBurn</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../lite-manage-roks/">Manage on IBM Cloud</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Other Playbooks</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../ocp/">OCP Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../dependencies/">Dependencies Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cp4d/">CP4D Playbooks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mas/">MAS Playbooks</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Roles</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/amqstreams/">amqstreams</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ansible_version_check/">ansible_version_check</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/appconnect_install/">appconnect_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cos_setup/">cos_setup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_db2wh/">cp4d_db2wh</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_db2wh_backup/">cp4d_db2wh_backup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_db2wh_manage_hack/">cp4d_db2wh_manage_hack</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_db2wh_restore/">cp4d_db2wh_restore</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_hack_worker_nodes/">cp4d_hack_worker_nodes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_install/">cp4d_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_install_services/">cp4d_install_services</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/db2u/">db2u</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/gencfg_sls/">gencfg_sls</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/gencfg_workspace/">gencfg_workspace</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/install_operator/">install_operator</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/mongodb/">mongodb</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_deprovision/">ocp_deprovision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_login/">ocp_login</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_provision/">ocp_provision</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_setup_github_oauth/">ocp_setup_github_oauth</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_setup_mas_deps/">ocp_setup_mas_deps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_setup_ocs/">ocp_setup_ocs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_verify/">ocp_verify</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/sls_install/">sls_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_configure/">suite_app_configure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_install/">suite_app_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_config/">suite_config</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_dns/">suite_dns</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_install/">suite_install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_mustgather/">suite_mustgather</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_verify/">suite_verify</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../roles/uds_install/">uds_install</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MAS Devops Collection</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Full Stack Playbooks &raquo;</li>
        
      
    
    <li>IBM Cloud</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/playbooks/fullstack-roks.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="full-stack-on-ibm-cloud">Full Stack on IBM Cloud<a class="headerlink" href="#full-stack-on-ibm-cloud" title="Permanent link"></a></h1>
<p>This master playbook will drive the following playbooks in sequence:</p>
<ul>
<li><a href="../ocp/#provision">Provision &amp; setup OCP on IBM Cloud</a> (20-30 minutes)</li>
<li>Install dependencies:<ul>
<li><a href="../dependencies/#install-mongodb-ce">Install MongoDb (Community Edition)</a> (10 minutes)</li>
<li><a href="../dependencies/#install-amq-streams">Install Kafka (AMQ Streams)</a> (10 minutes)</li>
<li><a href="../dependencies/#install-sls">Install SLS</a> (10 minutes)</li>
<li><a href="../dependencies/#install-uds">Install UDS</a> (35 minutes)</li>
<li><a href="../cp4d/#install-cp4d">Install Cloud Pak for Data Operator</a> (2 minutes)</li>
<li><a href="../dependencies/#install-appconnect">Install AppConnect</a> (?)</li>
<li>Install Cloud Pak for Data Services:<ul>
<li><a href="../cp4d/#db2-install">Db2 Warehouse</a> (1 hour)</li>
<li><a href="../cp4d/#watson-studio-install">Watson Studio</a> with <a href="../cp4d/#watson-studio-install">Apache Spark</a>, <a href="../cp4d/#watson-studio-install">Watson Machine Learning</a>, &amp; <a href="../cp4d/#watson-studio-install">Watson AI OpenScale</a> (4-5 hours)</li>
</ul>
</li>
<li><a href="../cp4d/#install-db2">Create Db2 Warehouse Cluster</a> (45 minutes)</li>
<li><a href="../mas/#manage-db2-hack">Additional Db2 configuration for Manage</a> (5 minutes)</li>
</ul>
</li>
<li>Install &amp; configure MAS:<ul>
<li><a href="../mas/#cloud-internet-services-integration">Configure Cloud Internet Services integration</a> (Optional, 1 minute)</li>
<li>Generate MAS Workspace Configuration (1 minute)</li>
<li><a href="../mas/#install-mas">Install &amp; configure MAS</a> (15 minutes)</li>
</ul>
</li>
<li>Install applications:<ul>
<li><a href="../mas/#install-mas-application">Install &amp; configure Manage</a> (10 minute install + 2 hours configure)</li>
<li><a href="../mas/#install-mas-application">Install &amp; configure IoT</a> (25 minute install + 5 minutes configure)</li>
<li><a href="../mas/#install-mas-application">Install &amp; configure Monitor</a> (10 minute install + ? configure)</li>
<li><a href="../mas/#install-mas-application">Install &amp; configure Predict</a> (10 minute install + 5 minutes configure)</li>
<li><a href="../mas/#install-mas-application">Install &amp; configure Safety</a> (? minute install + ? configure)</li>
<li><a href="../mas/#install-mas-application">Install &amp; configure Maximo Scheduler Optmization</a> (10 minute install + ? configure)</li>
<li><a href="../mas/#install-mas-application">Install &amp; configure Health &amp; Predict Utilities</a> (10 minute install + ? configure)</li>
</ul>
</li>
</ul>
<p>All timings are estimates, see the individual pages for each of these playbooks for more information.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The install time for Cloud Pak for Data with all the services supported by MAS enabled is considerable.  Unfortunately this is out of our control, plan accordingly!</p>
<p>Also note that Cloud Pak for Data requires approximately 40 PVCs.  You may need to contact IBM to increase the quota assigned to your IBM Cloud account if you see PVCs stuck in pending state and this error message: "Your order will exceed the maximum number of storage volumes allowed. Please contact Sales"</p>
</div>
<h2 id="preparation">Preparation<a class="headerlink" href="#preparation" title="Permanent link"></a></h2>
<p>Before you run the playbook you need to configure a few things in your <code>MAS_CONFIG_DIR</code>:</p>
<h3 id="copy-your-entitlement-license-key-file">Copy your entitlement license key file<a class="headerlink" href="#copy-your-entitlement-license-key-file" title="Permanent link"></a></h3>
<p>Copy the MAS license key file that you obtained from Rational License Key Server to <code>$MAS_CONFIG_DIR/entitlement.lic</code> (the file must have this exact name).  During the installation of SLS this license file will be automatically bootstrapped into the system.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make sure you set <code>SLS_LICENSE_ID</code> to the correct value.  For full details on what configuration options are available with the SLS install refer to the <a href="../dependencies/#install-sls">Install SLS</a> topic.</p>
</div>
<h2 id="required-environment-variables">Required environment variables<a class="headerlink" href="#required-environment-variables" title="Permanent link"></a></h2>
<ul>
<li><code>IBMCLOUD_APIKEY</code> The API key that will be used to create a new ROKS cluster in IBMCloud</li>
<li><code>CLUSTER_NAME</code> The name to assign to the new ROKS cluster</li>
<li><code>MAS_INSTANCE_ID</code> Declare the instance ID for the MAS install</li>
<li><code>MAS_ENTITLEMENT_KEY</code> Lookup your entitlement key from the <a href="https://myibm.ibm.com/products-services/containerlibrary">IBM Container Library</a></li>
<li><code>MAS_CONFIG_DIR</code> Directory where generated config files will be saved (you may also provide pre-generated config files here)</li>
<li><code>SLS_LICENSE_ID</code> The license ID must match the license file available in <code>$MAS_CONFIG_DIR/entitlement.lic</code></li>
<li><code>SLS_ENTITLEMENT_KEY</code> Lookup your entitlement key from the <a href="https://myibm.ibm.com/products-services/containerlibrary">IBM Container Library</a></li>
<li><code>UDS_CONTACT_EMAIL</code> Defines the email for person to contact for BAS</li>
<li><code>UDS_CONTACT_FIRSTNAME</code> Defines the first name of the person to contact for BAS</li>
<li><code>UDS_CONTACT_LASTNAME</code> Defines the last name of the person to contact for BAS</li>
<li><code>CPD_ENTITLEMENT_KEY</code> Lookup your entitlement key from the [IBM Container Library](https://myibm.ibm.com/</li>
</ul>
<h2 id="optional-environment-variables">Optional environment variables<a class="headerlink" href="#optional-environment-variables" title="Permanent link"></a></h2>
<ul>
<li><code>IBMCLOUD_RESOURCEGROUP</code> creates an IBM Cloud resource group to be used, if none are passed, <code>Default</code> resource group will be used.</li>
<li><code>OCP_VERSION</code> to override the default version of OCP to use (latest 4.6 release)</li>
<li><code>W3_USERNAME</code> to enable access to pre-release development builds of MAS</li>
<li><code>ARTIFACTORY_APIKEY</code>  to enable access to pre-release development builds of MAS</li>
<li><code>KAFKA_CLUSTER_SIZE</code> to override the default configuration used (small)</li>
<li><code>MONGODB_NAMESPACE</code> overrides the Kubernetes namespace where the MongoDb CE operator will be installed, this will default to <code>mongoce</code></li>
<li><code>MAS_CATALOG_SOURCE</code> to override the use of the IBM Operator Catalog as the catalog source</li>
<li><code>MAS_CHANNEL</code> to override the use of the <code>8.x</code> channel</li>
<li><code>MAS_DOMAIN</code> to set a custom domain for the MAS installation</li>
<li><code>MAS_UPGRADE_STRATEGY</code> to override the use of Manual upgrade strategy.</li>
<li><code>MAS_ICR_CP</code> to override the value MAS uses for the IBM Entitled Registry (<code>cp.icr.io/cp</code>)</li>
<li><code>MAS_ICR_CPOPEN</code> to override the value MAS uses for the IBM Open Registry (<code>icr.io/cpopen</code>)</li>
<li><code>MAS_ENTITLEMENT_USERNAME</code> to override the username MAS uses to access content in the IBM Entitled Registry</li>
<li><code>CIS_CRN</code> to enable integration with IBM Cloud Internet Services (CIS) for DNS &amp; certificate management</li>
<li><code>CIS_SUBDOMAIN</code> if you want to use a subdomain within your CIS instance</li>
<li><code>CPD_WSL_PROJECT_ID</code> to set a Watson Studio project id to be passed to HP Utilities application during its deployment and configuration. If not set, a new project will be created in Watson Studio automatically to configure HP Utilities application in the MAS instance created by this playbook</li>
<li><code>CPD_WSL_PROJECT_NAME</code> to set a Watson Studio project name, if not set a default project name will be used</li>
<li><code>CPD_WSL_PROJECT_DESCRIPTION</code> - to set a Watson Studio project description, if not set a default project description will be used</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><code>MAS_ICR_CP</code>, <code>MAS_ICR_CPOPEN</code>, &amp; <code>MAS_ENTITLEMENT_USERNAME</code> are primarily used when working with pre-release builds in conjunction with <code>W3_USERNAME</code>, <code>ARTIFACTORY_APIKEY</code> and the <code>MAS_CATALOG_SOURCE</code> environment variables.</p>
</div>
<h2 id="release-build">Release build<a class="headerlink" href="#release-build" title="Permanent link"></a></h2>
<pre><code class="language-bash"># IBM Cloud ROKS configuration
export IBMCLOUD_APIKEY=xxx
export CLUSTER_NAME=xxx

# CP4D configuration
export CPD_ENTITLEMENT_KEY=xxx

# MAS configuration
export MAS_INSTANCE_ID=xxx
export MAS_ENTITLEMENT_KEY=xxx

export MAS_CONFIG_DIR=~/masconfig

# SLS configuration
export SLS_ENTITLEMENT_KEY=xxx
export SLS_LICENSE_ID=xxx

# BAS configuration
export UDS_CONTACT_EMAIL=xxx@xxx.com
export UDS_CONTACT_FIRSTNAME=xxx
export UDS_CONTACT_LASTNAME=xxx

ansible-playbook playbooks/fullstack-roks.yml
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Lookup your entitlement keys from the <a href="https://myibm.ibm.com/products-services/containerlibrary">IBM Container Library</a></p>
</div>
<h2 id="pre-release-build">Pre-release build<a class="headerlink" href="#pre-release-build" title="Permanent link"></a></h2>
<pre><code class="language-bash"># IBM Cloud ROKS configuration
export IBMCLOUD_APIKEY=xxx
export CLUSTER_NAME=xxx

# CP4D configuration
export CPD_ENTITLEMENT_KEY=xxx

# Allow development catalogs to be installed
export W3_USERNAME=xxx
export ARTIFACTORY_APIKEY=xxx

# MAS configuration
export MAS_CATALOG_SOURCE=ibm-mas-operators
export MAS_CHANNEL=m1dev87
export MAS_INSTANCE_ID=$CLUSTER_NAME

export MAS_ICR_CP=wiotp-docker-local.artifactory.swg-devops.com
export MAS_ICR_CPOPEN=wiotp-docker-local.artifactory.swg-devops.com
export MAS_ENTITLEMENT_USERNAME=$W3_USERNAME_LOWERCASE
export MAS_ENTITLEMENT_KEY=$ARTIFACTORY_APIKEY

export MAS_CONFIG_DIR=~/masconfig

# SLS configuration
export SLS_ENTITLEMENT_KEY=xxx
export SLS_LICENSE_ID=xxx

# BAS configuration
export UDS_CONTACT_EMAIL=xxx@xxx.com
export UDS_CONTACT_FIRSTNAME=xxx
export UDS_CONTACT_LASTNAME=xxx

ansible-playbook playbooks/fullstack-roks.yml
</code></pre>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/ansible-devops/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../.." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../lite-core-roks/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
